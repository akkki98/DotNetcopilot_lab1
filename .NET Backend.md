Lab: Building a .NET Backend API with GitHub Copilot
Lab Scenario

You are working as a backend developer for QuickKart, an online retail platform. Your task is to build a Product Management API using ASP.NET Core Web API.

You will use GitHub Copilot to accelerate development in:

Generating REST API endpoints

Implementing database operations using EF Core

Adding structured error handling and logging

Writing unit tests using xUnit and Moq

The final output will be a fully working backend with:

ProductsController

EF Core repository + DbContext

Logging and error handling middleware

Unit test project

Prerequisites

.NET 8 SDK

Visual Studio / VS Code

SQL Server LocalDB or SQLite

GitHub Copilot enabled

Lab Objectives

By the end of this lab, you will:

Build API endpoints using Copilot prompts

Scaffold EF Core models, DbContext, and repository

Add centralized error handling and logging

Generate unit tests

Lab Part 1 â€” Create the .NET Web API Project
Step 1: Create the project
dotnet new webapi -o QuickKart.API
cd QuickKart.API

Step 2: Install EF Core packages
dotnet add package Microsoft.EntityFrameworkCore
dotnet add package Microsoft.EntityFrameworkCore.Sqlite
dotnet add package Microsoft.EntityFrameworkCore.Tools

Lab Part 2 â€” Generate API Endpoints Using Copilot
Task

Create a ProductsController with CRUD endpoints.

Copilot Prompt

Generate a ProductsController with CRUD endpoints for Product model using ASP.NET Core Web API.

Expected Copilot Output (Example)
[ApiController]
[Route("api/[controller]")]
public class ProductsController : ControllerBase
{
    private readonly IProductRepository _repo;

    public ProductsController(IProductRepository repo)
    {
        _repo = repo;
    }

    [HttpGet]
    public async Task<IActionResult> GetAll() =>
        Ok(await _repo.GetAllAsync());

    [HttpGet("{id}")]
    public async Task<IActionResult> Get(int id)
    {
        var product = await _repo.GetAsync(id);
        if (product == null) return NotFound();
        return Ok(product);
    }

    [HttpPost]
    public async Task<IActionResult> Create(Product product)
    {
        await _repo.AddAsync(product);
        return CreatedAtAction(nameof(Get), new { id = product.Id }, product);
    }

    [HttpPut("{id}")]
    public async Task<IActionResult> Update(int id, Product product)
    {
        if (id != product.Id) return BadRequest();
        await _repo.UpdateAsync(product);
        return NoContent();
    }

    [HttpDelete("{id}")]
    public async Task<IActionResult> Delete(int id)
    {
        await _repo.DeleteAsync(id);
        return NoContent();
    }
}

Lab Part 3 â€” Database Operations Using Copilot
Task

Use EF Core (SQLite) to create:

Product Model

AppDbContext

IProductRepository + ProductRepository

Copilot Prompt: Product Model

Generate a Product entity with Id, Name, Price, Stock properties.

Copilot Prompt: DbContext

Create an EF Core DbContext named AppDbContext with Products DbSet.

Copilot Prompt: Repository

Create IProductRepository and ProductRepository implementing CRUD using EF Core.

Expected Interface Example
public interface IProductRepository
{
    Task<List<Product>> GetAllAsync();
    Task<Product?> GetAsync(int id);
    Task AddAsync(Product product);
    Task UpdateAsync(Product product);
    Task DeleteAsync(int id);
}

Lab Part 4 â€” Add Error Handling & Logging Using Copilot
Task

Add centralized error handling middleware.

Copilot Prompt

Generate ASP.NET Core middleware for global exception handling with logging using ILogger.

Expected Output
public class ErrorHandlingMiddleware
{
    private readonly RequestDelegate _next;
    private readonly ILogger<ErrorHandlingMiddleware> _logger;

    public ErrorHandlingMiddleware(RequestDelegate next, ILogger<ErrorHandlingMiddleware> logger)
    {
        _next = next;
        _logger = logger;
    }

    public async Task Invoke(HttpContext context)
    {
        try
        {
            await _next(context);
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Unhandled exception");
            context.Response.StatusCode = 500;
            await context.Response.WriteAsJsonAsync(new { message = "An error occurred" });
        }
    }
}

Add in Program.cs
app.UseMiddleware<ErrorHandlingMiddleware>();

Lab Part 5 â€” Unit Testing with Copilot
Task

Write unit tests for ProductsController using xUnit + Moq.

Create Test Project
dotnet new xunit -o QuickKart.Tests
dotnet add QuickKart.Tests package Moq
dotnet add QuickKart.Tests reference QuickKart.API

Copilot Prompt

Generate unit tests for ProductsController using xUnit and Moq.

Expected Copilot Output
public class ProductsControllerTests
{
    private readonly Mock<IProductRepository> _mockRepo;
    private readonly ProductsController _controller;

    public ProductsControllerTests()
    {
        _mockRepo = new Mock<IProductRepository>();
        _controller = new ProductsController(_mockRepo.Object);
    }

    [Fact]
    public async Task Get_ReturnsNotFound_WhenNotExists()
    {
        _mockRepo.Setup(r => r.GetAsync(1)).ReturnsAsync((Product?)null);

        var result = await _controller.Get(1);

        Assert.IsType<NotFoundResult>(result);
    }

    [Fact]
    public async Task Create_ReturnsCreatedResult()
    {
        var product = new Product
        {
            Id = 1,
            Name = "Test",
            Price = 10,
            Stock = 5
        };

        var result = await _controller.Create(product);

        Assert.IsType<CreatedAtActionResult>(result);
    }
}

ðŸŽ‰ Lab Completed

You have successfully created:

âœ” A fully functional .NET Web API

âœ” EF Core repository pattern

âœ” CRUD endpoints

âœ” Global error handler

âœ” Unit test suite

All generated or accelerated using GitHub Copilot.
